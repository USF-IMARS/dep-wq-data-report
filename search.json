[
  {
    "objectID": "parameter_report_template.html",
    "href": "parameter_report_template.html",
    "title": "Dep-wq-data-report",
    "section": "",
    "text": "Report\n\n\nCode\nif (!requireNamespace(\"librarian\", quietly = TRUE)) {\n  # If not installed, install the package\n  install.packages(\"librarian\")\n}\n\nlibrarian::shelf(\n  skimr,\n  ggplot2\n)\n\nsource(\"R/getData.R\")\n\n\n\n\nCode\ndata &lt;- getData()\nparameter_name &lt;- params$parameter_name\nprint(parameter_name)\n\n\n[1] \"Chlorophyll a\"\n\n\nCode\nsubset_data &lt;- subset(data, Parameter == parameter_name)\nprint(skimr::skim(subset_data))\n\n\n── Data Summary ────────────────────────\n                           Values     \nName                       subset_data\nNumber of rows             51196      \nNumber of columns          17         \n_______________________               \nColumn type frequency:                \n  character                10         \n  numeric                  7          \n________________________              \nGroup variables            None       \n\n── Variable type: character ────────────────────────────────────────────────────\n   skim_variable  n_missing complete_rate min max empty n_unique whitespace\n 1 Source                 0         1       3   7     0        8          0\n 2 Site                   0         1       1  28     0     1178          0\n 3 Latitude             581         0.989   8   8     0     4575          0\n 4 Longitude            583         0.989   9   9     0     5335          0\n 5 Parameter              0         1      13  13     0        1          0\n 6 Units                 27         0.999   4   4     0        2          0\n 7 Trend Analysis         0         1       2   3     0        2          0\n 8 Continuous             0         1       2   3     0        2          0\n 9 End Date               0         1       4   7     0       15          0\n10 Value_orig           685         0.987   1  13     0    18971          0\n\n── Variable type: numeric ──────────────────────────────────────────────────────\n  skim_variable n_missing complete_rate     mean       sd       p0       p25\n1 ...1                  0         1     30493.   48063.      1     12801.   \n2 Month                 0         1         6.59     3.43    1         4    \n3 Year                  0         1      2012.       7.90 1995      2006    \n4 Value              1282         0.975     1.82     5.14   -0.048     0.286\n5 Total Depth       33794         0.340     9.05     9.25    0         3.05 \n6 Sample Depth       8402         0.836     1.01    16.8     0         0.1  \n7 Start Date            0         1      1999.       9.92 1988      1988    \n       p50      p75    p100 hist \n1 25600.   38839.   717530  ▇▁▁▁▁\n2     7       10        12  ▇▅▅▅▇\n3  2013     2019      2022  ▂▃▅▅▇\n4     0.58     1.58    300  ▇▁▁▁▁\n5     6       11.4     121. ▇▁▁▁▁\n6     0.5      0.5    2494  ▇▁▁▁▁\n7  1998     2005      2021  ▇▇▅▁▃\n\n\n\n\nCode\np &lt;- ggplot2::ggplot(subset_data, aes(x=Value)) +\n    geom_histogram(bins=30, fill=\"blue\", color=\"black\") +\n    scale_y_log10() +  # Transform the y-axis to a logarithmic scale\n    labs(title=paste(\"Histogram of Values for\", parameter_name),\n         x=\"Value\",\n         y=\"Log Frequency\") +\n    theme_minimal()\n\nprint(p)"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Dep-wq-data-report",
    "section": "",
    "text": "Data files overview:\n\n\n(code) import libraries & functions\nif (!requireNamespace(\"librarian\", quietly = TRUE)) {\n  # If not installed, install the package\n  install.packages(\"librarian\")\n}\n\nlibrarian::shelf(\n  readr,\n  skimr,\n  glue,\n  ggplot2,\n  quarto\n)\nsource(\"R/getData.R\")\n\n\nThere are three relevant types of data file provided:\n\n\n(code) preview the raw data\ninspectData &lt;- function(fpath){\n  print(fpath)\n  df &lt;- readr::read_csv(fpath)\n  print(head(df))\n}\n\ninspectData(\"data/Merged_chla.csv\")\n\n\n[1] \"data/Merged_chla.csv\"\n\n\nRows: 60719 Columns: 9\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (4): Source, Site, Parameter, Units\ndbl (3): Month, Year, Value\nlgl (2): Total Depth, Sample Depth\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n# A tibble: 6 × 9\n  Source Site  Month  Year Parameter Value Units `Total Depth` `Sample Depth`\n  &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt; &lt;lgl&gt;         &lt;lgl&gt;         \n1 AOML   1         1  1998 chla      1.00  ug/L  NA            NA            \n2 AOML   2         1  1998 chla      0.556 ug/L  NA            NA            \n3 AOML   3         1  1998 chla      0.695 ug/L  NA            NA            \n4 AOML   4         1  1998 chla      0.427 ug/L  NA            NA            \n5 AOML   5         1  1998 chla      0.665 ug/L  NA            NA            \n6 AOML   6         1  1998 chla      0.267 ug/L  NA            NA            \n\n\n(code) preview the raw data\ninspectData(\"data/station_sampling_periods_for_all_programs.csv\")\n\n\n[1] \"data/station_sampling_periods_for_all_programs.csv\"\n\n\nRows: 998 Columns: 8\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (4): Source, Site, Currently Sampling?, Notes\ndbl (4): Lat, Long, Sample Start Year, Sample End Year\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n# A tibble: 6 × 8\n  Source Site    Lat  Long `Sample Start Year` `Sample End Year`\n  &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;               &lt;dbl&gt;             &lt;dbl&gt;\n1 DERM   AC01   25.9 -80.1                2015              2021\n2 DERM   AC03   25.9 -80.2                2015              2021\n3 DERM   AC06   25.9 -80.2                2015              2021\n4 DERM   AR03   25.3 -80.4                2015              2021\n5 DERM   BB02   25.9 -80.1                2015              2021\n6 DERM   BB04   25.9 -80.1                2015              2021\n# ℹ 2 more variables: `Currently Sampling?` &lt;chr&gt;, Notes &lt;chr&gt;\n\n\n(code) preview the raw data\ninspectData(\"data/Unified_WQ_Database_1995-2022.csv\")\n\n\n[1] \"data/Unified_WQ_Database_1995-2022.csv\"\n\n\nNew names:\nRows: 612830 Columns: 16\n── Column specification\n──────────────────────────────────────────────────────── Delimiter: \",\" chr\n(10): Source, Site, Latitude, Longitude, Parameter, Value, Units, Trend ... dbl\n(6): ...1, Month, Year, Total Depth, Sample Depth, Start Date\nℹ Use `spec()` to retrieve the full column specification for this data. ℹ\nSpecify the column types or set `show_col_types = FALSE` to quiet this message.\n• `` -&gt; `...1`\n\n\n# A tibble: 6 × 16\n   ...1 Source Site  Latitude Longitude Month  Year Parameter     Value    Units\n  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;    &lt;chr&gt;\n1     1 AOML   1     25.64330 -80.12670     1  1998 Chlorophyll a 1.00488  ug/L \n2     2 AOML   2     25.64330 -80.10500     1  1998 Chlorophyll a 0.555864 ug/L \n3     3 AOML   3     25.63830 -80.08330     1  1998 Chlorophyll a 0.695148 ug/L \n4     4 AOML   4     25.10830 -80.38000     1  1998 Chlorophyll a 0.426756 ug/L \n5     5 AOML   5     25.09330 -80.35330     1  1998 Chlorophyll a 0.66462  ug/L \n6     6 AOML   6     25.06330 -80.31500     1  1998 Chlorophyll a 0.26712  ug/L \n# ℹ 6 more variables: `Total Depth` &lt;dbl&gt;, `Sample Depth` &lt;dbl&gt;,\n#   `Trend Analysis` &lt;chr&gt;, Continuous &lt;chr&gt;, `Start Date` &lt;dbl&gt;,\n#   `End Date` &lt;chr&gt;\n\n\nHere is a summarizing table of what I see in each:\n\n\n\n\n\n\n\n\n\nfilename\ngeospatial info\ndt info\n\n\n\n\n\nMerged_*.csv\ndepth?+source+site\nMM-YYYY\n\n\n\nstation_sampling_periods_for_all_programs.csv\nlat+lon+source+site\n\nstart+end year + still sampling\n\n\nUnified_WQ_Database_1995-2022.csv\nlat+lon+source+site\nMM-YYYY\nstart+end + still sampling\n\n\n\nSo… in theory Unified_WQ_Database_1995-2022.csv contains everything we could need.\n\n\nExploratory analyses\nA skim view of the data as it loads in:\n\n\n(code) skim the data\ndata &lt;- readr::read_csv(\"data/Unified_WQ_Database_1995-2022.csv\")\n\nskimr::skim(data)\n\n\n\nData summary\n\n\nName\ndata\n\n\nNumber of rows\n612830\n\n\nNumber of columns\n16\n\n\n_______________________\n\n\n\nColumn type frequency:\n\n\n\ncharacter\n10\n\n\nnumeric\n6\n\n\n________________________\n\n\n\nGroup variables\nNone\n\n\n\nVariable type: character\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmin\nmax\nempty\nn_unique\nwhitespace\n\n\n\n\nSource\n0\n1.00\n3\n11\n0\n9\n0\n\n\nSite\n0\n1.00\n1\n28\n0\n1411\n0\n\n\nLatitude\n5462\n0.99\n8\n8\n0\n4739\n0\n\n\nLongitude\n5496\n0.99\n9\n9\n0\n5495\n0\n\n\nParameter\n0\n1.00\n6\n24\n0\n11\n0\n\n\nValue\n29273\n0.95\n1\n13\n0\n88595\n0\n\n\nUnits\n968\n1.00\n2\n9\n0\n13\n0\n\n\nTrend Analysis\n154\n1.00\n2\n3\n0\n2\n0\n\n\nContinuous\n154\n1.00\n2\n3\n0\n2\n0\n\n\nEnd Date\n154\n1.00\n4\n7\n0\n15\n0\n\n\n\nVariable type: numeric\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmean\nsd\np0\np25\np50\np75\np100\nhist\n\n\n\n\n…1\n0\n1.00\n360505.76\n206864.14\n1\n182543.25\n365608.5\n537933.8\n717536.00\n▇▇▇▇▇\n\n\nMonth\n63\n1.00\n6.54\n3.43\n1\n4.00\n7.0\n10.0\n12.00\n▇▅▅▅▇\n\n\nYear\n63\n1.00\n2012.03\n7.92\n1995\n2006.00\n2013.0\n2019.0\n2022.00\n▂▃▅▃▇\n\n\nTotal Depth\n345777\n0.44\n10.21\n10.14\n0\n3.75\n7.3\n12.0\n120.57\n▇▁▁▁▁\n\n\nSample Depth\n132515\n0.78\n3.62\n13.44\n0\n0.50\n0.5\n3.2\n2494.00\n▇▁▁▁▁\n\n\nStart Date\n154\n1.00\n1999.21\n11.08\n1988\n1988.00\n1998.0\n2005.0\n2022.00\n▇▃▃▁▃\n\n\n\n\n\nThe Value is reading in as “Character” when it should be “Numeric”. We can convert it and view the rows that are being lost because they read as non-numeric:\n\n\n(code) view bad rows\ndata &lt;- getData()  # the getData in getData.R reads and converts the Value col \n\n\nNew names:\nRows: 612830 Columns: 16\n── Column specification\n──────────────────────────────────────────────────────── Delimiter: \",\" chr\n(10): Source, Site, Latitude, Longitude, Parameter, Value, Units, Trend ... dbl\n(6): ...1, Month, Year, Total Depth, Sample Depth, Start Date\nℹ Use `spec()` to retrieve the full column specification for this data. ℹ\nSpecify the column types or set `show_col_types = FALSE` to quiet this message.\n• `` -&gt; `...1`\n\n\nWarning in getData(): NAs introduced by coercion\n\n\n(code) view bad rows\nna_rows &lt;- is.na(data$Value) & !is.na(data$Value_orig)\nna_introduced_rows &lt;- data[na_rows, ]\n\nprint(na_introduced_rows)\n\n\n# A tibble: 4,989 × 17\n    ...1 Source Site    Latitude Longitude Month  Year Parameter     Value Units\n   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;\n 1 10172 AOML   AMI4    27.38060 -83.03420     8  2022 Chlorophyll a    NA ug/L \n 2 10178 AOML   V3      27.03630 -82.61340     8  2022 Chlorophyll a    NA ug/L \n 3 60251 FIU    Sta 351 24.69170 -81.79170     1  2011 Chlorophyll a    NA ug/L \n 4 60252 FIU    Sta 351 24.69170 -81.79170     4  2011 Chlorophyll a    NA ug/L \n 5 60253 FIU    Sta 351 24.69170 -81.79170     7  2011 Chlorophyll a    NA ug/L \n 6 60309 FIU    Sta 352 24.77580 -81.78300     1  2011 Chlorophyll a    NA ug/L \n 7 60310 FIU    Sta 352 24.77580 -81.78300     4  2011 Chlorophyll a    NA ug/L \n 8 60311 FIU    Sta 352 24.77580 -81.78300     7  2011 Chlorophyll a    NA ug/L \n 9 60367 FIU    Sta 353 24.85830 -81.77670     1  2011 Chlorophyll a    NA ug/L \n10 60368 FIU    Sta 353 24.85830 -81.77670     4  2011 Chlorophyll a    NA ug/L \n# ℹ 4,979 more rows\n# ℹ 7 more variables: `Total Depth` &lt;dbl&gt;, `Sample Depth` &lt;dbl&gt;,\n#   `Trend Analysis` &lt;chr&gt;, Continuous &lt;chr&gt;, `Start Date` &lt;dbl&gt;,\n#   `End Date` &lt;chr&gt;, Value_orig &lt;chr&gt;\n\n\nThe unique problem values in the “Values” column:\n\n\n(code) view bad Value values\nprint(unique(na_introduced_rows$Value_orig))\n\n\n[1] \"Spilled\"       \"TRUE\"          \"FALSE\"         \"*Non-detect\"  \n[5] \"*Not Reported\" \"ND\""
  },
  {
    "objectID": "provider_sites_report.html",
    "href": "provider_sites_report.html",
    "title": "Sites Report",
    "section": "",
    "text": "(code) import libraries & functions\nif (!requireNamespace(\"librarian\", quietly = TRUE)) {\n  # If not installed, install the package\n  install.packages(\"librarian\")\n}\n\n# librarian::shelf(\n#   \n# )\nsource(\"R/getData.R\")\n\n\n\nSites\nA summary of which sites meet quality assessment checks to be included in the final map.\n\n\nCode\ndata &lt;- getData()\n\n\nNew names:\nRows: 612830 Columns: 16\n── Column specification\n──────────────────────────────────────────────────────── Delimiter: \",\" chr\n(10): Source, Site, Latitude, Longitude, Parameter, Value, Units, Trend ... dbl\n(6): ...1, Month, Year, Total Depth, Sample Depth, Start Date\nℹ Use `spec()` to retrieve the full column specification for this data. ℹ\nSpecify the column types or set `show_col_types = FALSE` to quiet this message.\n• `` -&gt; `...1`\n\n\nWarning in getData(): NAs introduced by coercion\n\n\nCode\nunique_sources &lt;- unique(data$Source)\nprint(unique_sources)\n\n\n[1] \"AOML\"        \"DERM\"        \"BROWARD\"     \"DEP\"         \"FIU\"        \n[6] \"21FLWQA\"     \"BBAP\"        \"Miami Beach\" \"BBWW\"       \n\n\nRender a report for each data provider:\n#| label: print wq report links #| code-summary: (code) view wq report links #| results: asis # passthrough html+markdown\nfor (wq_param in unique_parameters) { # NOTE: this line is copied from last loop filepath = paste(“parameter_report_”, wq_param, “.html”, sep = ““)\nprint(glue::glue(“* {filepath} ”)) }"
  },
  {
    "objectID": "provider_report_template.html",
    "href": "provider_report_template.html",
    "title": "Report for Data Provider",
    "section": "",
    "text": "(code) import libraries & functions\nif (!requireNamespace(\"librarian\", quietly = TRUE)) {\n  # If not installed, install the package\n  install.packages(\"librarian\")\n}\n\nlibrarian::shelf(\n  dplyr\n)\nsource(\"R/getData.R\")\ndata &lt;- getData()\n\n# Count the number of rows for each Source\nsource_counts &lt;- data %&gt;%\n  dplyr::group_by(Source) %&gt;%\n  # dplyr::summarise(Count = dplyr::n())\n  summarise(\n    NA_Count = sum(is.na(Value)),\n    Valid_Value_Count = sum(!is.na(Value))\n  )\n\n# View the counts\nprint(source_counts)\n\n\n# A tibble: 9 × 3\n  Source      NA_Count Valid_Value_Count\n  &lt;chr&gt;          &lt;int&gt;             &lt;int&gt;\n1 21FLWQA         2617             15404\n2 AOML           20433             53122\n3 BBAP               0              4321\n4 BBWW             264              1215\n5 BROWARD            0             16392\n6 DEP                0            106607\n7 DERM               0            120698\n8 FIU            10948            251036\n9 Miami Beach        0              9773"
  },
  {
    "objectID": "parameters_report.html",
    "href": "parameters_report.html",
    "title": "Parameters Report",
    "section": "",
    "text": "(code) import libraries & functions\nif (!requireNamespace(\"librarian\", quietly = TRUE)) {\n  # If not installed, install the package\n  install.packages(\"librarian\")\n}\n\nlibrarian::shelf(\n  glue,\n  quarto\n)\nsource(\"R/getData.R\")\n\n\n\nParameters\nAvailable parameters:\n\n\n(code) view unique parameters\ndata &lt;- getData()\n\n\nNew names:\nRows: 612830 Columns: 16\n── Column specification\n──────────────────────────────────────────────────────── Delimiter: \",\" chr\n(10): Source, Site, Latitude, Longitude, Parameter, Value, Units, Trend ... dbl\n(6): ...1, Month, Year, Total Depth, Sample Depth, Start Date\nℹ Use `spec()` to retrieve the full column specification for this data. ℹ\nSpecify the column types or set `show_col_types = FALSE` to quiet this message.\n• `` -&gt; `...1`\n\n\nWarning in getData(): NAs introduced by coercion\n\n\n(code) view unique parameters\n# print unique values in `Parameter` column\nunique_parameters &lt;- unique(data$Parameter)\nprint(unique_parameters)\n\n\n [1] \"Chlorophyll a\"            \"Ammonium (N)\"            \n [3] \"Nitrate-Nitrite (N)\"      \"Nitrite (N)\"             \n [5] \"Nitrate (N)\"              \"Orthophosphate (P)\"      \n [7] \"Silica\"                   \"Nitrogen- Total\"         \n [9] \"Nitrogen- Total Kjeldahl\" \"Phosphorus- Total\"       \n[11] \"Turbidity\"               \n\n\n(code) view unique parameters\n# NOTE: this ran for 20min and never finished\n# # create a violin plot of `Value` grouped by each `Parameter`\n# ggplot2::ggplot(df, aes(x=Parameter, y=Value)) +\n#     geom_violin(trim=FALSE) +\n#     theme(axis.text.x = element_text(angle = 90, hjust = 1)) +\n#     labs(title=\"Violin Plot of Values by Parameter\",\n#          x=\"Parameter\",\n#          y=\"Value\")\n\n\nRender a report for each parameter:\n\n(code) view wq report links\nfor (wq_param in unique_parameters) {\n  # NOTE: this line is copied from last loop\n  filepath = paste(\"parameter_report_\", wq_param, \".html\", sep = \"\")\n\n  print(glue::glue(\"* [{filepath}](./{filepath}) \\n\"))\n}\n\n\nparameter_report_Chlorophyll a.html\nparameter_report_Ammonium (N).html\nparameter_report_Nitrate-Nitrite (N).html\nparameter_report_Nitrite (N).html\nparameter_report_Nitrate (N).html\nparameter_report_Orthophosphate (P).html\nparameter_report_Silica.html\nparameter_report_Nitrogen- Total.html\nparameter_report_Nitrogen- Total Kjeldahl.html\nparameter_report_Phosphorus- Total.html\nparameter_report_Turbidity.html"
  }
]